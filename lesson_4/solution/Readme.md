# Решение к домашней работе "Знакомство с HDFS"

## Задача

Требуется написать Scala-приложение, которое будет очищать данные из папки `/stage` и складывать их в папку `/ods` в корне HDFS по следующим правилам:

1. Структура партиций (папок вида date=...) должна сохраниться.
1. Внутри папок должен остаться только один файл, содержащий все данные файлов из соответствующей партиции в папке `/stage`.

То есть, если у нас есть папка `/stage/date=2020-11-11` с файлами
```
part-0000.csv
part-0001.csv
```
то должна получиться папка `/ods/date=2020-11-11` с одним файлом `part-0000.csv`
содержащим все данные из файлов папки `/stage/date=2020-11-11`.

## Решение

0. Собрать список папок из `/stage` по маске `date=*`
1. Для каждой папки: прочитать все файлы в массив
2. Для каждого не пустого массива в исходной папке создать папку в `/ods`
3. Записать массив в файл `part-0000.csv`
